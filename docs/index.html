



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>Real Time Sensor Fusion for Loss Detection at Checkout</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-154731555-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#real-time-sensor-fusion-for-loss-detection-at-checkout-reference-design" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="." title="Real Time Sensor Fusion for Loss Detection at Checkout" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Real Time Sensor Fusion for Loss Detection at Checkout
            </span>
            <span class="md-header-nav__topic">
              
                Real Time Sensor Fusion for Loss Detection at Checkout Reference Design
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="." title="Real Time Sensor Fusion for Loss Detection at Checkout" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Real Time Sensor Fusion for Loss Detection at Checkout
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Real Time Sensor Fusion for Loss Detection at Checkout Reference Design
      </label>
    
    <a href="." title="Real Time Sensor Fusion for Loss Detection at Checkout Reference Design" class="md-nav__link md-nav__link--active">
      Real Time Sensor Fusion for Loss Detection at Checkout Reference Design
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#block-diagram" class="md-nav__link">
    Block Diagram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-domain-knowledge" class="md-nav__link">
    Recommended Domain Knowledge
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting Started
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-clone-the-repository" class="md-nav__link">
    Step 1: Clone the repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-build-the-reference-design" class="md-nav__link">
    Step 2: Build the Reference Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-build-edgex-rest-device-service" class="md-nav__link">
    Step 3: Build EdgeX REST Device service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-use-docker-compose-to-start-the-reference-design-suite-to-do-so-use" class="md-nav__link">
    Step 4: Use docker-compose to start the reference design suite. To do so, use
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-use-the-event-simulator" class="md-nav__link">
    Step 5: Use the Event Simulator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-integrate-your-pos-of-choice" class="md-nav__link">
    Step 6: Integrate your POS of choice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-integrate-your-security-scale-of-choice" class="md-nav__link">
    Step 7: Integrate your Security Scale of choice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-optional-build-the-intel-retail-sensor-platform-intel-rsp-controller" class="md-nav__link">
    Step 8: (optional) Build the Intel® Retail Sensor Platform (Intel® RSP) Controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9-optional-build-video-analytics-serving-intels-computer-vision-reference-design" class="md-nav__link">
    Step 9: (optional) Build Video Analytics Serving (Intel's Computer Vision Reference Design)**
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-the-compose-files" class="md-nav__link">
    How to Use the Compose Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#components-to-build-a-solution-based-on-this-reference-design" class="md-nav__link">
    Components to Build a Solution based on this Reference Design
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#components-to-consider-adding" class="md-nav__link">
    Components to Consider Adding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components-to-consider-replacing-or-enhancing" class="md-nav__link">
    Components to Consider Replacing or Enhancing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-send-notifications-through-edgex-optional" class="md-nav__link">
    How to Send Notifications through EdgeX (optional)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-set-environment-variables" class="md-nav__link">
    Step 1: Set Environment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-add-code-to-the-config-seed-environment-section" class="md-nav__link">
    Step 2: Add code to the config-seed Environment Section
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-add-smtp-server-to-compose-file-optional" class="md-nav__link">
    Step 3: Add SMTP Server to compose file (optional)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-dictionary" class="md-nav__link">
    Data Dictionary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references-and-links" class="md-nav__link">
    References and Links
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-services" class="md-nav__link">
    Application Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device-service" class="md-nav__link">
    Device Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-services" class="md-nav__link">
    Helper Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intel-rsp-rfid-solution" class="md-nav__link">
    Intel® RSP RFID Solution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other" class="md-nav__link">
    Other
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="device_services/" title="Device services" class="md-nav__link">
      Device services
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="unicenta/" title="Instructions for Integrating with uniCenta oPOS" class="md-nav__link">
      Instructions for Integrating with uniCenta oPOS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Rtsf at checkout events
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Rtsf at checkout events
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="rtsf_at_checkout_events/checkout_events/" title="Checkout events" class="md-nav__link">
      Checkout events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="rtsf_at_checkout_events/event_simulation/" title="Event simulation" class="md-nav__link">
      Event simulation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#block-diagram" class="md-nav__link">
    Block Diagram
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-domain-knowledge" class="md-nav__link">
    Recommended Domain Knowledge
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting Started
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-clone-the-repository" class="md-nav__link">
    Step 1: Clone the repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-build-the-reference-design" class="md-nav__link">
    Step 2: Build the Reference Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-build-edgex-rest-device-service" class="md-nav__link">
    Step 3: Build EdgeX REST Device service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-use-docker-compose-to-start-the-reference-design-suite-to-do-so-use" class="md-nav__link">
    Step 4: Use docker-compose to start the reference design suite. To do so, use
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-use-the-event-simulator" class="md-nav__link">
    Step 5: Use the Event Simulator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-integrate-your-pos-of-choice" class="md-nav__link">
    Step 6: Integrate your POS of choice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-integrate-your-security-scale-of-choice" class="md-nav__link">
    Step 7: Integrate your Security Scale of choice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-optional-build-the-intel-retail-sensor-platform-intel-rsp-controller" class="md-nav__link">
    Step 8: (optional) Build the Intel® Retail Sensor Platform (Intel® RSP) Controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9-optional-build-video-analytics-serving-intels-computer-vision-reference-design" class="md-nav__link">
    Step 9: (optional) Build Video Analytics Serving (Intel's Computer Vision Reference Design)**
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-the-compose-files" class="md-nav__link">
    How to Use the Compose Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#components-to-build-a-solution-based-on-this-reference-design" class="md-nav__link">
    Components to Build a Solution based on this Reference Design
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#components-to-consider-adding" class="md-nav__link">
    Components to Consider Adding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#components-to-consider-replacing-or-enhancing" class="md-nav__link">
    Components to Consider Replacing or Enhancing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-send-notifications-through-edgex-optional" class="md-nav__link">
    How to Send Notifications through EdgeX (optional)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-set-environment-variables" class="md-nav__link">
    Step 1: Set Environment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-add-code-to-the-config-seed-environment-section" class="md-nav__link">
    Step 2: Add code to the config-seed Environment Section
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-add-smtp-server-to-compose-file-optional" class="md-nav__link">
    Step 3: Add SMTP Server to compose file (optional)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-dictionary" class="md-nav__link">
    Data Dictionary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references-and-links" class="md-nav__link">
    References and Links
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-services" class="md-nav__link">
    Application Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device-service" class="md-nav__link">
    Device Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-services" class="md-nav__link">
    Helper Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intel-rsp-rfid-solution" class="md-nav__link">
    Intel® RSP RFID Solution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other" class="md-nav__link">
    Other
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="real-time-sensor-fusion-for-loss-detection-at-checkout-reference-design">Real Time Sensor Fusion for Loss Detection at Checkout Reference Design</h1>
<h2 id="introduction">Introduction</h2>
<p>This guide helps you build and run the Real Time Sensor Fusion for Loss Detection at Checkout Reference Design.</p>
<p>Upon completing the steps in this guide, you will be ready to integrate sensors and services to build your own complete solution.</p>
<blockquote>
<p><em>Important: This guide does not create a complete, ready-to-use solution. Instead, upon completing the steps in this guide, you will be ready to integrate sensors and services to build your own Real Time Sensor Fusion for Loss Detection at Checkout solution.</em></p>
</blockquote>
<h3 id="block-diagram">Block Diagram</h3>
<p>The high-level diagram below shows the sensors and services used with the Real Time Sensor Fusion for Loss Detection at Checkout Reference Design. The diagram shows the sensors and services, and how they communicate through EdgeX. Intel provides the services outlined in green, and you must obtain EdgeX and the sensors and services in pink.
<img alt="Real Time Sensor Fusion for Loss Detection at Checkout Diagram" src="rtsf-loss-detection-at-checkout.png" /></p>
<h3 id="prerequisites">Prerequisites</h3>
<p>The following items are required to build the Real Time Sensor Fusion for Loss Detection at Checkout Reference Design. You will need additional hardware and software when you are ready to build your own solution. </p>
<ul>
<li>Point-of-Sale (POS) of choice. You must use a POS that integrates with either the EdgeX REST or MQTT Device. See <a href="rtsf_at_checkout_events/checkout_events/#pos-events">POS Events</a> for information about integration with the <a href="device_services/#edgex-rest-and-mqtt-device-services">EdgeX Device Services</a> to send POS Events</li>
<li>Docker</li>
<li>Docker-Compose</li>
<li>Go 1.12+</li>
<li>GIT</li>
<li>make</li>
</ul>
<h3 id="recommended-domain-knowledge">Recommended Domain Knowledge</h3>
<ul>
<li>MQTT</li>
<li>REST</li>
<li>POS systems, including customizations (Transactions, Real-Time Transaction Log (RTTL))</li>
<li>Computer Vision concepts, if using CV Components</li>
<li>RFID concepts, if using RFID Components</li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<h3 id="step-1-clone-the-repository">Step 1: Clone the repository</h3>
<div class="codehilite"><pre><span></span><span class="n">git</span> <span class="n">clone</span>  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">intel</span><span class="o">-</span><span class="n">iot</span><span class="o">-</span><span class="n">devkit</span><span class="o">/</span><span class="n">rtsf</span><span class="o">-</span><span class="k">at</span><span class="o">-</span><span class="n">checkout</span><span class="o">-</span><span class="n">reference</span><span class="o">-</span><span class="n">design</span>
</pre></div>


<h3 id="step-2-build-the-reference-design">Step 2: Build the Reference Design</h3>
<p>You must build the provided component services and create local docker images. To do so, run</p>
<div class="codehilite"><pre><span></span><span class="n">make</span> <span class="n">docker</span>
</pre></div>


<p>which builds the following docker images</p>
<ul>
<li><code>rtsf-at-checkout/event-reconciler</code></li>
<li><code>rtsf-at-checkout/device-scale</code></li>
<li><code>rtsf-at-checkout/product-lookup</code></li>
<li><code>rtsf-at-checkout/loss-detector</code></li>
<li><code>rtsf-at-checkout/rsp-controller-event-handler</code></li>
<li><code>rtsf-at-checkout/cv-region-of-interest</code></li>
</ul>
<h3 id="step-3-build-edgex-rest-device-service">Step 3: Build EdgeX REST Device service</h3>
<p>The EdgeX REST device service is currently the process of being released. Until a release docker image is available via Edge Foundry, we must build it locally by running the following command:</p>
<div class="codehilite"><pre><span></span><span class="n">make</span> <span class="n">device</span><span class="o">-</span><span class="n">rest</span>
</pre></div>


<p>which creates the following docker image:</p>
<ul>
<li><code>edgexfoundry/docker-device-rest-go</code></li>
</ul>
<p>This make target will clone the device-rest-go repo and build the docker image.</p>
<h3 id="step-4-use-docker-compose-to-start-the-reference-design-suite-to-do-so-use">Step 4: Use docker-compose to start the reference design suite. To do so, use</h3>
<div class="codehilite"><pre><span></span><span class="n">make</span> <span class="n">run</span><span class="o">-</span><span class="n">base</span>
</pre></div>


<p>This command starts all the EdgeX services and then starts all the Loss Detection services.</p>
<h3 id="step-5-use-the-event-simulator">Step 5: Use the Event Simulator</h3>
<p>Use the <a href="rtsf_at_checkout_events/event_simulation/">Event Simulator</a> to test and explore the example reference design until you feel comfortable with it.</p>
<p>You have successfully created an example reference design and are ready to integrate your components to create your own Real Time Sensor Fusion for Loss Detection at Checkout solution.</p>
<h3 id="step-6-integrate-your-pos-of-choice">Step 6: Integrate your POS of choice</h3>
<p>Your POS of choice must send <strong>POS Events</strong> to either the Edgex REST or MQTT Device service. See the <a href="rtsf_at_checkout_events/checkout_events/#pos_ events">POS Events</a> section for details about each <strong>POS event</strong> and the <a href="device_services/">Device Services</a> section for details on how to send the events. </p>
<p>If you don't currently have a POS of choice, we recommend using the <strong>uniCenta </strong> open source POS to get familiar with the POS integration. The <a href="unicenta/">uniCenta </a> section has details on installing and integrating <strong>uniCenta </strong>.</p>
<h3 id="step-7-integrate-your-security-scale-of-choice">Step 7: Integrate your Security Scale of choice</h3>
<p>TBD</p>
<h3 id="step-8-optional-build-the-intel-retail-sensor-platform-intel-rsp-controller">Step 8: (optional) Build the Intel® Retail Sensor Platform (Intel® RSP) Controller</h3>
<p>If you want to use the Intel® RSP application with your RFID sensors, run the following command:</p>
<div class="codehilite"><pre><span></span><span class="n">make</span> <span class="n">rsp</span>
</pre></div>


<p>which will create these docker images:</p>
<ul>
<li><code>rsp/mqtt-device-service</code></li>
<li><code>rsp/sw-toolkit-gw</code></li>
<li><code>rsp/avahi</code></li>
<li><code>rsp/ntp</code></li>
</ul>
<p>This make target will clone the RSP repositories and run the appropriate scripts. Once complete you will need to stop the that docker stack that the scripts started so you can use the compose file provided by this reference design. This is required because the <code>rsp-sw-toolkit-installer</code> build script runs the RSP docker-compose file. To take down the docker stack:</p>
<div class="codehilite"><pre><span></span>docker-compose -p rsp -f <span class="nv">$PROJECTS_DIR</span>/rsp-sw-toolkit-installer/docker/compose/docker-compose.yml down
</pre></div>


<p>Run the following command to start the RSP services:</p>
<div class="codehilite"><pre><span></span><span class="n">make</span> <span class="n">run</span><span class="o">-</span><span class="n">rsp</span>
</pre></div>


<h3 id="step-9-optional-build-video-analytics-serving-intels-computer-vision-reference-design">Step 9: (optional) Build Video Analytics Serving (Intel's Computer Vision Reference Design)**</h3>
<p>To use the Intel Video Analytics Serving application, run the following command:</p>
<div class="codehilite"><pre><span></span><span class="n">make</span> <span class="n">vas</span>
</pre></div>


<p>which will create the following docker image:</p>
<ul>
<li><code>video_analytics_serving_gstreamer</code></li>
</ul>
<p>This make target will clone the VAS repo and run the appropriate scripts to create the docker image.</p>
<p>Run the following command to start the VAP services:</p>
<div class="codehilite"><pre><span></span><span class="n">make</span> <span class="n">run</span><span class="o">-</span><span class="n">vap</span>
</pre></div>


<h2 id="how-to-use-the-compose-files">How to Use the Compose Files</h2>
<p>The docker-compose files are divided up to let you bring up or take down individual sensor ingestion components. Visit each individual <a href="#references-and-links-to-the-documentation-of-the-individual-components">GitHub subrepository</a> to learn about the responsibility of each service. </p>
<table>
<thead>
<tr>
<th>Compose File</th>
<th>Purpose</th>
<th>Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>Portainer</td>
<td>Container management</td>
<td><code>docker-compose -f docker-compose.portainer.yml up -d</code></td>
</tr>
<tr>
<td>EdgeX and its components</td>
<td></td>
<td><code>docker-compose -f docker-compose.edgex.yml up -d</code></td>
</tr>
<tr>
<td>Real Time Sensor Fusion for Loss Detection at Checkout Core Services and its components</td>
<td></td>
<td><code>docker-compose -f docker-compose.loss-detection.yml up -d</code></td>
</tr>
<tr>
<td>RFID Components (Intel® RSP SW Toolkit)</td>
<td></td>
<td><code>docker-compose -f docker-compose.rsp.yml up -d</code></td>
</tr>
<tr>
<td>Video Analytics Pipeline (VAP)</td>
<td></td>
<td><code>docker-compose -f docker-compose.vap.yml up -d</code></td>
</tr>
</tbody>
</table>
<h2 id="components-to-build-a-solution-based-on-this-reference-design">Components to Build a Solution based on this Reference Design</h2>
<p>The reference design you created is not a complete solution. It provides the base components for creating a sensor fusion based framework. It is your choice on how many and which sensors to include. This section provides information about components you might want to include or replace.</p>
<h3 id="components-to-consider-adding">Components to Consider Adding</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Security scale in bagging area</td>
<td>A Scale Device service is provided for a CAS USB scale. As an alternative, you can have Scale Events sent to either the EdgeX REST or MQTT Device Services. For more information, see  <a href="rtsf_at_checkout_events/checkout_events/#scale-events">Scale Events</a> and integrating with the <a href="device_services/#edgex-rest-and-mqtt-device-services">EdgeX Device Services</a> to send the Scale Events.</td>
</tr>
<tr>
<td>Computer Vision (CV) Object Detection Model</td>
<td>The Intel® Distribution of OpenVINO toolkit-based object detection model used by the Video Analytics Pipeline (VAP) service is provided as an example, but is not intended for your final solution. The VAP and CV ROI Enter Exit service in this reference design create the CV ROI Events that are sent to the <a href="device_services/#edgex-mqtt-device-service">EdgeX MQTT Device Service</a>. See <a href="rtsf_at_checkout_events/checkout_events/#cv-roi-events">CV ROI Events</a>.</td>
</tr>
<tr>
<td>Intel® RFID Sensors</td>
<td>This reference design relies on the Intel® Retail Sensor Platform (Intel® RSP). (https://software.intel.com/en-us/retail/rfid-sensor-platform)<strong> which has its own custom EdgeX Device Service which it sends RFID events. These events are transformed into RFID ROI Events by the provided </strong>RSP Controller Event Handler** service. See below for details on <a href="rtsf_at_checkout_events/checkout_events/#rfid-roi-events">RFID ROI Events</a>.This RSP has its own custom EdgeX Device Service to which it sends RFID events. These events are transformed into RFID ROI Events by the provided RSP Controller Event Handler service. If you are interested in Intel® RSP RFID Sensors, see https://software.intel.com/en-us/retail/rfid-sensor-platform#buy</td>
</tr>
<tr>
<td>Reconciler Service</td>
<td>This service provided does the analytics of reconciling all the sensor events to identify suspect items. As an option, you can replace the provided service with a more advanced service.</td>
</tr>
<tr>
<td>Detector Service</td>
<td>The service provided demonstrates how to send an email notification using the EdgeX Notifications service. The contents of the email is a simple JSON list of suspect items. As an option, you can replace the provided service with a more advanced service.</td>
</tr>
<tr>
<td>Computer Vision Region of Interest (ROI) Solution</td>
<td>If you chose to create your own complete Computer Vision object detection and CV ROI enter/exit solution. Exclude running the components in the docker-compose.vap.yml compose file and remove the cv-region-of-interest from the docker-compose.loss-detection.yml compose file. Integrate your CV solution with either the EdgeX REST or MQTT Device Services to send the CV ROI events.</td>
</tr>
</tbody>
</table>
<h3 id="components-to-consider-replacing-or-enhancing">Components to Consider Replacing or Enhancing</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reconciler service</td>
<td>The Reconciler Service performs the analytics of reconciling the sensor events to identify suspect items. While the service provided performs adequately, your analytics team might be able to improve on this reference implementation.</td>
</tr>
<tr>
<td>Detector Service</td>
<td>The Dectector Service demonstrates how to send email notifications using the EdgeX Notifications service. The email message content is a simple JSON list of suspect items.</td>
</tr>
<tr>
<td>Product Lookup Service</td>
<td>This service provided is a basic implementation of a Product Information Management Lookup service. It uses a JSON file as a database for the product information. It is recommended that you replace the service with an Enterprise Resource Planning (ERP) System.</td>
</tr>
<tr>
<td>RFID services</td>
<td>If you choose to use a different RFID solution, in addition to providing your integration to generate the RFID ROI Events you will need to exclude running the components in the <code>docker-compose.rsp.yml</code> compose file and remove the <code>rsp-controller-event-handler</code> from the <code>docker-compose.loss-detection.yml</code> compose file.  You will also need to integrate your RFID solution with either the EdgeX REST or MQTT Device Services to send the RFID events. See below for details on <a href="rtsf_at_checkout_events/checkout_events/#rfid-roi-events">RFID ROI events</a> and integrating with these <a href="device_services/#edgex-rest-and-mqtt-device-services">EdgeX Device Services</a> to send RFID ROI events.</td>
</tr>
</tbody>
</table>
<h2 id="how-to-send-notifications-through-edgex-optional">How to Send Notifications through EdgeX (optional)</h2>
<p>This section provides instructions to help you configure the EdgeX notifications service to send alerts through SMS, email, Rest calls, and others. </p>
<p>Notifications work as follows: </p>
<ol>
<li>
<p>When the reconciler receives a payment-start event, it sends a message to the loss-detector that contain the suspect items list. </p>
</li>
<li>
<p>The loss-detector sends these alerts as email messages through the EdgeX notification service. </p>
</li>
<li>
<p>The loss-detector initiates the connection to the EdgeX notifications service.</p>
</li>
</ol>
<p>To change the message type from email to a different medium, you must update the loss-detector.</p>
<h3 id="step-1-set-environment-variables">Step 1: Set Environment Variables</h3>
<p>Set environment variable overrides for <code>Smtp_Host</code> and <code>Smtp_Port</code> in 'config-seed', which will inject these variables into the notification service's registry. </p>
<p>Additional notification service configuration properties are <a href="https://docs.edgexfoundry.org/Ch-AlertsNotifications.html#configuration-properties" title="EdgeX Alerts &amp; Notifications">here</a>.</p>
<h3 id="step-2-add-code-to-the-config-seed-environment-section">Step 2: Add code to the config-seed Environment Section</h3>
<p>The code snippet below is a docker-compose example that sends an email notification. Add this code to the config-seed environment section in <code>docker-compose.edgex.yml</code>, under the config-seed service.</p>
<div class="codehilite"><pre><span></span><span class="nt">environment</span><span class="p">:</span>
  <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*common-variables</span>
  <span class="nt">Smtp_Host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;host name&gt;</span>
  <span class="nt">Smtp_Port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">25</span>
  <span class="nt">Smtp_Password</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;password if applicable&gt;</span>
  <span class="nt">Smtp_Sender</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;some email&gt;</span>
  <span class="nt">Smtp_Subject</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">EdgeX Notification Suspect List</span>
</pre></div>


<h3 id="step-3-add-smtp-server-to-compose-file-optional">Step 3: Add SMTP Server to compose file (optional)</h3>
<p>The snipped below adds a development SMTP server smtp4dev to your <code>docker-compose.loss-detection.yml</code>. 
Skip this step if you want to use Gmail or another server.</p>
<div class="codehilite"><pre><span></span><span class="nt">smtp-server</span><span class="p">:</span>
  <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rnwood/smtp4dev:linux-amd64-v3</span>
  <span class="nt">ports</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&quot;3000:80&quot;</span>
    <span class="p p-Indicator">-</span> <span class="s">&quot;2525:25&quot;</span>
  <span class="nt">restart</span><span class="p">:</span> <span class="s">&quot;on-failure:5&quot;</span>
  <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">smtp-server</span>
  <span class="nt">networks</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">theft-detection-app_edgex-network</span>
</pre></div>


<h2 id="data-dictionary">Data Dictionary</h2>
<p>The data dictionary table below describes the JSON object fields for the <a href="rtsf_at_checkout_events/checkout_events/#rtsf-at-checkout-events">Real Time Sensor Fusion for Loss Detection at Checkout Events</a>.</p>
<table>
<thead>
<tr>
<th>Field Name</th>
<th>Data Type</th>
<th>Events used in</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>lane_id</td>
<td>string</td>
<td>All</td>
<td>Unique identifier of the self checkout lane</td>
</tr>
<tr>
<td>event_time</td>
<td>number</td>
<td>All</td>
<td>Unix nanosecond timestamp of when the event occured</td>
</tr>
<tr>
<td>basket_id</td>
<td>string</td>
<td>All <a href="rtsf_at_checkout_events/checkout_events/#pos-events">POS Events</a></td>
<td>Unique identifier of self checkout session basket</td>
</tr>
<tr>
<td>customer_id</td>
<td>string</td>
<td>All <a href="rtsf_at_checkout_events/checkout_events/#pos-events">POS Events</a></td>
<td>Optional unique identifier of the customer using the self checkout.</td>
</tr>
<tr>
<td>employee_id</td>
<td>string</td>
<td>All <a href="rtsf_at_checkout_events/checkout_events/#pos-events">POS Events</a></td>
<td>Optional unique identifier of the employee overseeing the self checkout.</td>
</tr>
<tr>
<td>product_id</td>
<td>string</td>
<td>POS <a href="rtsf_at_checkout_events/checkout_events/#pos-events">Scanned Item</a></td>
<td>Unique identifier of the product that was scanned. <br /><strong>This reference design expects a 14 digit UPC</strong></td>
</tr>
<tr>
<td>product_id_type</td>
<td>string</td>
<td>POS <a href="rtsf_at_checkout_events/checkout_events/#pos-events">Scanned Item</a></td>
<td>Type of the associated product ID. Value can be <code>UPC</code>, <code>SKU</code>, or <code>PLU</code>. <br /><strong>This reference design expects <code>UPC</code></strong></td>
</tr>
<tr>
<td>product_name</td>
<td>string</td>
<td>POS <a href="rtsf_at_checkout_events/checkout_events/#pos-events">Scanned Item</a></td>
<td>Name of the product that was scanned</td>
</tr>
<tr>
<td>quantity</td>
<td>number</td>
<td>POS <a href="rtsf_at_checkout_events/checkout_events/#pos-events">Scanned Item</a></td>
<td>Quantity of the products that were scanned</td>
</tr>
<tr>
<td>quantity_unit</td>
<td>string</td>
<td>POS <a href="rtsf_at_checkout_events/checkout_events/#pos-events">Scanned Item</a></td>
<td>Units for the associated quantity. <br />Values can be <code>EA</code>, <code>Each</code>, <code>lbs</code>, <code>g</code>, <code>kg</code> or <code>oz</code><br /><strong>This reference design expects <code>EA</code>, <code>Each</code>, or <code>lbs</code></strong></td>
</tr>
<tr>
<td>unit_price</td>
<td>number</td>
<td>POS <a href="rtsf_at_checkout_events/checkout_events/#pos-events">Scanned Item</a></td>
<td>Price of the individual products scanned.</td>
</tr>
<tr>
<td>scale_id</td>
<td>string</td>
<td><a href="rtsf_at_checkout_events/checkout_events/#scale-events">Scale Item</a></td>
<td>Unique identifier for the scale sending the events</td>
</tr>
<tr>
<td>total</td>
<td>number</td>
<td><a href="rtsf_at_checkout_events/checkout_events/#scale-events">Scale Item</a></td>
<td>Total weight for items on the scale</td>
</tr>
<tr>
<td>units</td>
<td>string</td>
<td><a href="rtsf_at_checkout_events/checkout_events/#scale-events">Scale Item</a></td>
<td>Units for the associated total weight.<br />Values can be <code>lbs</code>, <code>g</code>, <code>kg</code> or <code>oz</code> <br /><strong>This reference design expects <code>lbs</code></strong></td>
</tr>
<tr>
<td>product_name</td>
<td>string</td>
<td><a href="rtsf_at_checkout_events/checkout_events/#cv-roi-events">CV ROI</a></td>
<td>Unique identifier of the product identified by CV object detection.</td>
</tr>
<tr>
<td>roi_action</td>
<td>string</td>
<td><a href="rtsf_at_checkout_events/checkout_events/#cv-roi-events">CV ROI</a> &amp; <a href="rtsf_at_checkout_events/checkout_events/#rfid-roi-events">RFID ROI</a></td>
<td>Action of the associate product identified.<br />Value can be either <code>ENTERED</code> or <code>EXITED</code>.</td>
</tr>
<tr>
<td>roi_name</td>
<td>string</td>
<td><a href="rtsf_at_checkout_events/checkout_events/#cv-roi-events">CV ROI</a> &amp; <a href="rtsf_at_checkout_events/checkout_events/#rfid-roi-events">RFID ROI</a></td>
<td>Name of the region that the associate product was identified with. See the <a href="configuration/#configuration">Configuration</a> section above for details on how these names after configured.</td>
</tr>
<tr>
<td>epc</td>
<td>string</td>
<td><a href="rtsf_at_checkout_events/checkout_events/#rfid-roi-events">RFID ROI</a></td>
<td>Unique EPC code of the product identified by RFID</td>
</tr>
</tbody>
</table>
<h2 id="references-and-links">References and Links</h2>
<blockquote>
<p>TODO: Update Links to individual RTSF at Checkout when open sourced</p>
</blockquote>
<h3 id="application-services">Application Services</h3>
<table>
<thead>
<tr>
<th>Service</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reconciler</td>
<td>https://github.impcloud.net/loss-prevention-at-pos/rtsf-at-checkout-event-reconciler</td>
</tr>
<tr>
<td>Product Lookup</td>
<td>https://github.impcloud.net/loss-prevention-at-pos/rtsf-at-checkout-product-lookup</td>
</tr>
<tr>
<td>RSP Controller Event Handler</td>
<td>https://github.impcloud.net/loss-prevention-at-pos/rtsf-at-checkout-rsp-controller-event-handler</td>
</tr>
<tr>
<td>Loss Detector</td>
<td>https://github.impcloud.net/loss-prevention-at-pos/rtsf-at-checkout-loss-detector</td>
</tr>
</tbody>
</table>
<h3 id="device-service">Device Service</h3>
<table>
<thead>
<tr>
<th>Service</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>Device Scale</td>
<td>https://github.impcloud.net/loss-prevention-at-pos/rtsf-at-checkout-device-scale</td>
</tr>
</tbody>
</table>
<h3 id="helper-services">Helper Services</h3>
<table>
<thead>
<tr>
<th>Service</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>CV ROI Service</td>
<td>https://github.impcloud.net/loss-prevention-at-pos/rtsf-at-checkout-cv-region-of-interest</td>
</tr>
<tr>
<td>Event Simulator</td>
<td>https://github.impcloud.net/loss-prevention-at-pos/rtsf-at-checkout-event-simulator</td>
</tr>
</tbody>
</table>
<h3 id="intel-rsp-rfid-solution">Intel® RSP RFID Solution</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intel® RSP Getting started</td>
<td>https://software.intel.com/en-us/getting-started-with-intel-rfid-sensor-platform-on-linux-6-use-the-web-portal</td>
</tr>
<tr>
<td>Intel® RSP installer</td>
<td>https://github.com/intel/rsp-sw-toolkit-installer</td>
</tr>
<tr>
<td>Intel® RSP gateway</td>
<td>https://github.com/intel/rsp-sw-toolkit-gw</td>
</tr>
<tr>
<td>Intel® RSP user guides</td>
<td>https://github.com/intel/rsp-sw-toolkit-gw/tree/master/docs</td>
</tr>
</tbody>
</table>
<h3 id="other">Other</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intel® Video Analytics Serving Documentation</td>
<td>https://github.com/intel/video-analytics-serving</td>
</tr>
<tr>
<td>Intel® Distribution of OpenVINO toolkit Documentation</td>
<td>https://software.intel.com/en-us/openvino-toolkit/documentation/featured</td>
</tr>
<tr>
<td>EdgeX GitHub Repos</td>
<td>https://github.com/edgexfoundry</td>
</tr>
</tbody>
</table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
        
          <a href="configuration/" title="Configuration" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Configuration
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
        <script src="https://unpkg.com/lunr/lunr.js"></script>
      
    
  </body>
</html>