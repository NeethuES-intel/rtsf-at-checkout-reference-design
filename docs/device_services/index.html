


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.0.1">
    
    
      
        <title>Device services - Real Time Sensor Fusion for Loss Detection at Checkout</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.c3000690.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
        
<link rel="preconnect dns-prefetch" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-154731555-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#edgex-rest-device-service" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Real Time Sensor Fusion for Loss Detection at Checkout" class="md-header-nav__button md-logo" aria-label="Real Time Sensor Fusion for Loss Detection at Checkout">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Real Time Sensor Fusion for Loss Detection at Checkout
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Device services
            
          </span>
        </div>
      
    </div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Real Time Sensor Fusion for Loss Detection at Checkout" class="md-nav__button md-logo" aria-label="Real Time Sensor Fusion for Loss Detection at Checkout">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    Real Time Sensor Fusion for Loss Detection at Checkout
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Real Time Sensor Fusion for Loss Detection at Checkout Reference Design" class="md-nav__link">
      Real Time Sensor Fusion for Loss Detection at Checkout Reference Design
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Phases
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Phases" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Phases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../phases/phase1/" title="Phase 1 - Simulate Events" class="md-nav__link">
      Phase 1 - Simulate Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../phases/phase2/" title="Phase 2 - Bring Your Own Software" class="md-nav__link">
      Phase 2 - Bring Your Own Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../phases/phase3/" title="Phase 3 - Bring Your Own Hardware" class="md-nav__link">
      Phase 3 - Bring Your Own Hardware
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      RTSF at Checkout Events
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="RTSF at Checkout Events" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        RTSF at Checkout Events
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rtsf_at_checkout_events/checkout_events/" title="Checkout events" class="md-nav__link">
      Checkout events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rtsf_at_checkout_events/event_simulation/" title="Event simulation" class="md-nav__link">
      Event simulation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Device services
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="Device services" class="md-nav__link md-nav__link--active">
      Device services
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#edgex-rest-device-service" class="md-nav__link">
    EdgeX REST Device service
  </a>
  
    <nav class="md-nav" aria-label="EdgeX REST Device service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#posting-to-edgex-rest-device-service" class="md-nav__link">
    POSTing to EdgeX REST Device Service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edgex-mqtt-device-service" class="md-nav__link">
    EdgeX MQTT Device service
  </a>
  
    <nav class="md-nav" aria-label="EdgeX MQTT Device service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publishing-to-edgex-mqtt-device-service" class="md-nav__link">
    Publishing to EdgeX MQTT Device Service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../notifications/" title="How to Send Notifications through EdgeX (optional)" class="md-nav__link">
      How to Send Notifications through EdgeX (optional)
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../references/" title="References" class="md-nav__link">
      References
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#edgex-rest-device-service" class="md-nav__link">
    EdgeX REST Device service
  </a>
  
    <nav class="md-nav" aria-label="EdgeX REST Device service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#posting-to-edgex-rest-device-service" class="md-nav__link">
    POSTing to EdgeX REST Device Service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edgex-mqtt-device-service" class="md-nav__link">
    EdgeX MQTT Device service
  </a>
  
    <nav class="md-nav" aria-label="EdgeX MQTT Device service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publishing-to-edgex-mqtt-device-service" class="md-nav__link">
    Publishing to EdgeX MQTT Device Service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                  <h1>Device services</h1>
                
                <p>The EdgeX REST and MQTT device services allow for an easy point of integration with this reference design. The above events can be sent to the underlying EdgeX framework using either of these device services. Note that the <strong>Intel Retail Sensor Platform (RSP) </strong>RFID solution has it's own custom EdgeX Device Service. </p>
<h2 id="edgex-rest-device-service">EdgeX REST Device service</h2>
<p>This reference design has configured the EdgeX REST device service to have the following devices which accept the above events.  </p>
<p><code>device-pos-rest</code> - Accepts the above POS events and defines the following device resources for each POS Event:</p>
<ul>
<li><code>basket-open</code></li>
<li><code>scanned-item</code></li>
<li><code>payment-start</code></li>
<li><code>payment-success</code></li>
<li><code>basket-close</code></li>
</ul>
<p><code>device-scale-rest</code> - Accepts the above Scale events and defines the following device resource for the single Scale Event:</p>
<ul>
<li><code>scale-item</code></li>
</ul>
<p><code>device-cv-roi-rest</code> - Accepts the above CV ROI events and defines the following device resource for the single CV ROI Event:</p>
<ul>
<li><code>cv-roi-event</code></li>
</ul>
<p><code>device-rfid-roi-rest</code>- Accepts the above RFID ROI events and defines the following device resource for the single RFID ROI Event:</p>
<ul>
<li><code>rfid-roi-event</code></li>
</ul>
<h3 id="posting-to-edgex-rest-device-service">POSTing to EdgeX REST Device Service</h3>
<p>This EdgeX REST Device service defines a parametrized endpoint for POSTing the JSON data for the event. This endpoint has the form:</p>
<div class="codehilite"><pre><span></span><code>/resource/{device name}/{resource name}
</code></pre></div>


<p>where <code>{device name}</code> is one of the above defined devices 
and <code>{resource name}</code> is one of the defined resource for that device.</p>
<p>Example URL for POSTing <code>basket-open</code> JSON data:</p>
<p><a href="https://localhost:49986/device-pos-rest/basket-open">http://localhost:49986/api/v1/resource/device-pos-rest/basket-open</a>
where the JSON body is:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;lane_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;basket_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abc-012345-def&quot;</span><span class="p">,</span>
    <span class="nt">&quot;customer_id&quot;</span><span class="p">:</span> <span class="s2">&quot;joe5&quot;</span><span class="p">,</span>
    <span class="nt">&quot;employee_id&quot;</span><span class="p">:</span> <span class="s2">&quot;mary1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;event_time&quot;</span> <span class="p">:</span> <span class="mi">15736013010000</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="edgex-mqtt-device-service">EdgeX MQTT Device service</h2>
<p>This reference design has configured the EdgeX MQTT device service to have the following devices which accept the above events.</p>
<p><code>device-pos-mqtt</code> - Accepts the above POS events and defines the following device commands for each POS Event:</p>
<ul>
<li><code>basket-open</code></li>
<li><code>scanned-item</code></li>
<li><code>payment-start</code></li>
<li><code>payment-success</code></li>
<li><code>basket-close</code></li>
</ul>
<p><code>device-scale-mqtt</code> - Accepts the above Scale events and defines the following device command for the single Scale Event:</p>
<ul>
<li><code>scale-item</code></li>
</ul>
<p><code>device-cv-roi-mqtt</code> - Accepts the above ROI events and defines the following device command for the single CV ROI Event:</p>
<ul>
<li><code>cv-roi-event</code></li>
</ul>
<p><code>device-rfid-roi-mqtt</code> Accepts the above RFID events and defines the following device command for the single RFID ROI Event:</p>
<ul>
<li><code>rfid-roi-event</code></li>
</ul>
<h3 id="publishing-to-edgex-mqtt-device-service">Publishing to EdgeX MQTT Device Service</h3>
<p>This EdgeX MQTT Device service accepts events published to the <code>edgex/#</code> topic. Events published to this topic must conform to the follow JSON schema:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;&lt;device name&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cmd&quot;</span> <span class="p">:</span> <span class="s2">&quot;&lt;command name&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;&lt;command name&gt;&quot;</span> <span class="p">:</span> <span class="s2">&quot;&lt;event data json&gt;&quot;</span>
<span class="p">}</span>
</code></pre></div>


<p>where <code>&lt;device name&gt;</code> is one of the above defined devices 
and <code>&lt;command name&gt;</code> is one of the defined commands for that device
and <code>&lt;event data json&gt;</code> is a string containing the event data JSON, i.e not embedded JSON.</p>
<p>Example JSON for publishing <code>scale-item</code> data:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;device-scale-mqtt&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cmd&quot;</span> <span class="p">:</span> <span class="s2">&quot;scale-item&quot;</span><span class="p">,</span>
    <span class="nt">&quot;scale-item&quot;</span> <span class="p">:</span> <span class="s2">&quot;{\&quot;lane_id\&quot;:\&quot;1\&quot;,\&quot;ScaleId\&quot;:\&quot;abc123\&quot;,\&quot;total\&quot;:3.25,\&quot;delta\&quot;:1.15,\&quot;units\&quot;:\&quot;lbs\&quot;,\&quot;event_time\&quot;:15736013940000}&quot;</span>
<span class="p">}</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../rtsf_at_checkout_events/event_simulation/" title="Event simulation" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Event simulation
              </div>
            </div>
          </a>
        
        
          <a href="../configuration/" title="Configuration" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Configuration
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.f45d2d8d.min.js"></script>
      <script src="../assets/javascripts/bundle.74d0b805.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://unpkg.com/lunr/lunr.js"></script>
      
    
  </body>
</html>