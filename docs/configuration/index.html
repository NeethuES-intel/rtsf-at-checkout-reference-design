


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.0.1">
    
    
      
        <title>Configuration - Real Time Sensor Fusion for Loss Detection at Checkout</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.c3000690.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
        
<link rel="preconnect dns-prefetch" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-154731555-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scale-device-service" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Real Time Sensor Fusion for Loss Detection at Checkout" class="md-header-nav__button md-logo" aria-label="Real Time Sensor Fusion for Loss Detection at Checkout">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Real Time Sensor Fusion for Loss Detection at Checkout
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Configuration
            
          </span>
        </div>
      
    </div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Real Time Sensor Fusion for Loss Detection at Checkout" class="md-nav__button md-logo" aria-label="Real Time Sensor Fusion for Loss Detection at Checkout">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    Real Time Sensor Fusion for Loss Detection at Checkout
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Real Time Sensor Fusion for Loss Detection at Checkout Reference Design" class="md-nav__link">
      Real Time Sensor Fusion for Loss Detection at Checkout Reference Design
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Phases
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Phases" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Phases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../phases/phase1/" title="Phase 1 - Simulate Events" class="md-nav__link">
      Phase 1 - Simulate Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../phases/phase2/" title="Phase 2 - Bring Your Own Software" class="md-nav__link">
      Phase 2 - Bring Your Own Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../phases/phase3/" title="Phase 3 - Bring Your Own Hardware" class="md-nav__link">
      Phase 3 - Bring Your Own Hardware
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      RTSF at Checkout Events
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="RTSF at Checkout Events" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        RTSF at Checkout Events
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rtsf_at_checkout_events/checkout_events/" title="Checkout events" class="md-nav__link">
      Checkout events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rtsf_at_checkout_events/event_simulation/" title="Event simulation" class="md-nav__link">
      Event simulation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../device_services/" title="Device services" class="md-nav__link">
      Device services
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Configuration
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="Configuration" class="md-nav__link md-nav__link--active">
      Configuration
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scale-device-service" class="md-nav__link">
    Scale Device Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edgex-mqtt-device-service" class="md-nav__link">
    EdgeX MQTT Device Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edgex-rest-device-service" class="md-nav__link">
    EdgeX REST Device Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intel-rsp-rfid-solution" class="md-nav__link">
    Intel RSP RFID Solution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rsp-controller-event-handler" class="md-nav__link">
    RSP Controller Event Handler
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cv-roi-service-video-analytics-pipeline" class="md-nav__link">
    CV ROI Service &amp; Video Analytics Pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#product-lookup" class="md-nav__link">
    Product Lookup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checkout-event-reconciler" class="md-nav__link">
    Checkout Event Reconciler
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss-detector" class="md-nav__link">
    Loss Detector
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checkout-event-simulator" class="md-nav__link">
    Checkout Event Simulator
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../notifications/" title="How to Send Notifications through EdgeX (optional)" class="md-nav__link">
      How to Send Notifications through EdgeX (optional)
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../references/" title="References" class="md-nav__link">
      References
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scale-device-service" class="md-nav__link">
    Scale Device Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edgex-mqtt-device-service" class="md-nav__link">
    EdgeX MQTT Device Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edgex-rest-device-service" class="md-nav__link">
    EdgeX REST Device Service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intel-rsp-rfid-solution" class="md-nav__link">
    Intel RSP RFID Solution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rsp-controller-event-handler" class="md-nav__link">
    RSP Controller Event Handler
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cv-roi-service-video-analytics-pipeline" class="md-nav__link">
    CV ROI Service &amp; Video Analytics Pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#product-lookup" class="md-nav__link">
    Product Lookup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checkout-event-reconciler" class="md-nav__link">
    Checkout Event Reconciler
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss-detector" class="md-nav__link">
    Loss Detector
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checkout-event-simulator" class="md-nav__link">
    Checkout Event Simulator
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                  <h1>Configuration</h1>
                
                <h2 id="scale-device-service">Scale Device Service</h2>
<p>The security scale used in this reference design is the <a href="http://www.cas-usa.com/products/pd-2">CAS PD-2 POS/Checkout Scale</a> which communicates over a serial connection. The vid:pid values of the scale are <code>VID = "0403"</code> and <code>PID = "6001"</code>. These values change depending on the model of scale you are using.  If you use a different scale, the logic to read and write to the scale will most likely be different. In this case, simply use this service as a reference for creating your custom Scale Device Service. </p>
<p>The following items can be configured via the <code>Driver</code> section of the service's <a href="https://github.com/intel-iot-devkit/rtsf-at-checkout-reference-design/blob/master/rtsf-at-checkout-device-scale/cmd/res/configuration.toml">configuration.toml</a> file. All values are strings.  </p>
<ul>
<li>ScaleVID - VID value for the scale</li>
<li>ScalePID - PID value for the scale</li>
<li>ScaleID - ID of the scale</li>
<li>LaneID - ID of the checkout lane the where the scale is being used</li>
<li>TimeOutMilli - Time out for when reading from the scale in milliseconds </li>
</ul>
<h2 id="edgex-mqtt-device-service">EdgeX MQTT Device Service</h2>
<p>This reference design uses the <a href="https://github.com/edgexfoundry/device-mqtt-go">MQTT Device Service</a> from EdgeX with custom device profiles. These device profiles YAML files are located at <a href="https://github.com/intel-iot-devkit/rtsf-at-checkout-reference-design/tree/master/loss-detection-app/res/device-mqtt-go">https://github.com/intel-iot-devkit/rtsf-at-checkout-reference-design/tree/master/loss-detection-app/res/device-mqtt-go</a> and are volume mounted into the device service's running Docker container.</p>
<p>The service's  <a href="https://github.com/intel-iot-devkit/rtsf-at-checkout-reference-design/rtsf-at-checkout-reference-design/blob/master/loss-detection-app/res/device-mqtt-go/docker/configuration.toml">configuration.toml</a> file has been customized to add the devices to the <code>DeviceList</code> section for each device profile and the following <code>Driver</code> section settings have been customized:</p>
<ul>
<li>IncomingTopic - Subscribe topic for the incoming MQTT Broker</li>
<li>IncomingHost - Host name of the incoming MQTT Broker</li>
<li>IncomingPort - Port number of the incoming MQTT Broker</li>
<li>IncomingUser - Username for the incoming MQTT Broker</li>
<li>IncomingPassword - Password for the incoming MQTT Broker</li>
<li>IncomingClientId - Client ID for the incoming MQTT Broker</li>
<li>IncomingKeepAlive - Keep alive duration for the incoming MQTT Broker</li>
<li>ResponseTopic - Subscribe topic for the response MQTT Broker</li>
<li>ResponseHost - Host name of the response MQTT Broker</li>
<li>ResponsePort - Port number of the response MQTT Broker</li>
<li>ResponseUser - Username for the response MQTT Broker</li>
<li>ResponsePassword - Password for the response MQTT Broker</li>
<li>ResponseClientId - Client ID for the response MQTT Broker</li>
<li>ResponseKeepAlive - Keep alive duration for the response MQTT Broker</li>
</ul>
<h2 id="edgex-rest-device-service">EdgeX REST Device Service</h2>
<p>This reference design uses the <a href="https://github.com/edgexfoundry/device-rest-go">REST Device Service</a> from EdgeX Foundry with custom device profiles. These device profiles YAML files are located at <a href="https://github.com/intel-iot-devkit/rtsf-at-checkout-reference-design/rtsf-at-checkout-reference-design/tree/master/loss-detection-app/res/device-rest-go]">https://github.com/intel-iot-devkit/rtsf-at-checkout-reference-design/rtsf-at-checkout-reference-design/tree/master/loss-detection-app/res/device-rest-go</a> and are volume mounted into the device service's running Docker container.</p>
<p>The service's  <a href="https://github.com/intel-iot-devkit/rtsf-at-checkout-reference-design/rtsf-at-checkout-reference-design/blob/master/loss-detection-app/res/device-rest-go/docker/configuration.toml">configuration.toml</a> file has been customized to add the devices to the <code>DeviceList</code> section for each device profile.</p>
<h2 id="intel-rsp-rfid-solution">Intel RSP RFID Solution</h2>
<p>This reference design uses the <a href="https://software.intel.com/en-us/retail/rfid-sensor-platform">Intel Retail Sensor Platform (RSP)</a> . Once installed you need to configure the custom facility ids by navigating to the web portal at <a href="http://localhost:8080/web-admin/">http://localhost:8080/web-admin/</a>.</p>
<p>Then navigate to the Cluster Config section using the dropdown menu and upload a custom cluster config file.  </p>
<p>Below is an example of two facilities Staging and Checkout. </p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span> 
   <span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;NrfClusterConfig&quot;</span><span class="p">,</span>
   <span class="nt">&quot;clusters&quot;</span><span class="p">:[</span> 
      <span class="p">{</span> 
         <span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;Staging&quot;</span><span class="p">,</span>
         <span class="nt">&quot;personality&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span>
         <span class="nt">&quot;facility_id&quot;</span><span class="p">:</span><span class="s2">&quot;Staging&quot;</span><span class="p">,</span>
         <span class="nt">&quot;aliases&quot;</span><span class="p">:[</span> 
            <span class="s2">&quot;Staging&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Staging&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Staging&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Staging&quot;</span>
         <span class="p">],</span>
         <span class="nt">&quot;behavior_id&quot;</span><span class="p">:</span><span class="s2">&quot;Staging_PORTS_1&quot;</span><span class="p">,</span>
         <span class="nt">&quot;sensor_groups&quot;</span><span class="p">:[</span> 
            <span class="p">[</span> 
               <span class="s2">&quot;RSP-150acc&quot;</span>
            <span class="p">]</span>
         <span class="p">]</span>
      <span class="p">},</span>
      <span class="p">{</span> 
         <span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;Checkout&quot;</span><span class="p">,</span>
         <span class="nt">&quot;personality&quot;</span><span class="p">:</span><span class="s2">&quot;EXIT&quot;</span><span class="p">,</span>
         <span class="nt">&quot;facility_id&quot;</span><span class="p">:</span><span class="s2">&quot;Checkout&quot;</span><span class="p">,</span>
         <span class="nt">&quot;aliases&quot;</span><span class="p">:[</span> 
            <span class="s2">&quot;Checkout&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Checkout&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Checkout&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Checkout&quot;</span>
         <span class="p">],</span>
         <span class="nt">&quot;behavior_id&quot;</span><span class="p">:</span><span class="s2">&quot;Checkout_PORTS_1&quot;</span><span class="p">,</span>
         <span class="nt">&quot;sensor_groups&quot;</span><span class="p">:[</span> 
            <span class="p">[</span> 
               <span class="s2">&quot;RSP-152419&quot;</span>
            <span class="p">]</span>
         <span class="p">]</span>
      <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>


<p>Below is what the new configuration should look like.  </p>
<p><img alt="RSP Configuration" src="../images/rsp-configuration.png" /></p>
<h2 id="rsp-controller-event-handler">RSP Controller Event Handler</h2>
<p>This service filters events from the RSP Controller and transforms them into a format that’s consumable by the Checkout Event Reconciler. The RSP Controller device name and the value descriptor for the events must be configured in the <code>ApplicationSettings</code> configuration section as follows: </p>
<ul>
<li>DeviceNames = “RSPController” </li>
<li>ValueDescriptorToFilter = “EventsJSON” </li>
</ul>
<h2 id="cv-roi-service-video-analytics-pipeline">CV ROI Service &amp; Video Analytics Pipeline</h2>
<p>CV consists of two components <code>video-analytic</code> and <code>cv-region-of-interest</code>. <code>*video-analytic</code> runs and maintains the CV pipelines.  <code>cv-region-of-interest</code> configures the pipelines, collects the frame by frame CV data and generates the CV ROI Events to send to EdgeX. </p>
<p>To configure the VAP pipeline you need to set the following environment variables in the docker-compose file under <code>cv-region-of-interest</code>. All the values other than the MQTT_DESTINATION_HOST are in the form CAMERA{N} where N is the camera number starting with 0. </p>
<p>In the <code>docker-compose.vap.yml</code> file under the <code>environment</code> section of <code>cv-region-of-interest</code></p>
<ul>
<li>MQTT_DESTINATION_HOST - the destination of the MQTT broker, to use the MQTT broker running in the compose file simply just use <code>mqtt:1883</code> </li>
<li>CAMERA{i}_ENDPOINT - the destination of the pipeline resource you wish to run the analytics on. Use <a href="http://video-analytic:8080/">http://video-analytic:8080</a> to hit the container running the VAS software then just add the route to the pipeline you are targeting. </li>
<li>CAMERA{i}_SRC - the path to the camera either RTSP or the Linux path to the camera resource </li>
<li>CAMERA{i}_ROI_NAME - the name of the ROI location this camera represents, this is a configurable parameter of the reconciler also and these ROI locations will need to match what is defined there as well. </li>
<li>
<p>CAMERA{i}_CROP_TBLR - the camera’s crop number of pixels to cut from the top, bottom, left, right. Try and crop the camera to just include the ROI of interest.</p>
</li>
<li>
<p>CAMERA{i}_PORT - the port that VAP will re-stream the live camera feed to with the crop and object detection overlays </p>
</li>
</ul>
<p>Here is an example configuration for one camera </p>
<div class="codehilite"><pre><span></span><code><span class="nt">environment</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">MQTT_DESTINATION_HOST=mqtt:1883</span> 
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CAMERA0_ENDPOINT=http://video-analytic:8080/pipelines/object_detection_cpu_render/1</span> 
  <span class="p p-Indicator">-</span> <span class="nt">CAMERA0_SRC=rtsp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">rtsp://{username}:{password}@{ip}</span> 
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CAMERA0_ROI_NAME=Staging</span> 
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CAMERA0_CROP_TBLR=245,210,260,800</span> 
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">CAMERA0_PORT=7001</span> 
</code></pre></div>


<p>For the <code>video-analytic</code> service the following configuration is needed. Adding the device <code>/dev/dri:/dev/dri</code> which mounts the GPU is optional. </p>
<div class="codehilite"><pre><span></span><code><span class="nt">environment</span><span class="p">:</span> 
  <span class="nt">DISPLAY</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${DISPLAY}</span> 
<span class="nt">devices</span><span class="p">:</span> 
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/dev/dri:/dev/dri</span> 
<span class="nt">volumes</span><span class="p">:</span> 
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/.X11-unix:/tmp/.X11-unix</span> 
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./pipelines:/pipelines</span> 
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./models:/models</span> 
</code></pre></div>


<p>For additional support see the Video Analytics Serving repo <a href="https://github.com/intel/video-analytics-serving">https://github.com/intel/video-analytics-serving</a>.  </p>
<h2 id="product-lookup">Product Lookup</h2>
<p>Product information values are stored in a JSON file. This inventory is used to lookup product information such as the product name, barcode, maximum and minimum weights and whether a product is RFID eligible.  </p>
<p>Example product lookup inventory is shown below:  </p>
<div class="codehilite"><pre><span></span><code><span class="p">[{</span> 
    <span class="nt">&quot;barcode&quot;</span><span class="p">:</span> <span class="s2">&quot;00022000008916&quot;</span><span class="p">,</span> 
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Extra Peppermint Gum&quot;</span><span class="p">,</span> 
    <span class="nt">&quot;min_weight&quot;</span><span class="p">:</span> <span class="mf">0.102</span><span class="p">,</span> 
    <span class="nt">&quot;max_weight&quot;</span><span class="p">:</span> <span class="mf">0.109</span><span class="p">,</span> 
    <span class="nt">&quot;rfid_eligible&quot;</span><span class="p">:</span> <span class="kc">true</span> 
<span class="p">},</span> 
<span class="p">{</span> 
    <span class="nt">&quot;barcode&quot;</span><span class="p">:</span> <span class="s2">&quot;00051700988235&quot;</span><span class="p">,</span> 
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Finish Dishwasher Tablet&quot;</span><span class="p">,</span> 
    <span class="nt">&quot;min_weight&quot;</span><span class="p">:</span> <span class="mf">0.610</span><span class="p">,</span> 
    <span class="nt">&quot;max_weight&quot;</span><span class="p">:</span> <span class="mf">0.620</span><span class="p">,</span> 
    <span class="nt">&quot;rfid_eligible&quot;</span><span class="p">:</span> <span class="kc">false</span> 
<span class="p">},</span> 
<span class="p">{</span> 
    <span class="nt">&quot;barcode&quot;</span><span class="p">:</span> <span class="s2">&quot;00012000163173&quot;</span><span class="p">,</span> 
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mountain Dew 6 Pack&quot;</span><span class="p">,</span> 
    <span class="nt">&quot;min_weight&quot;</span><span class="p">:</span> <span class="mf">3.200</span><span class="p">,</span> 
    <span class="nt">&quot;max_weight&quot;</span><span class="p">:</span> <span class="mf">3.255</span><span class="p">,</span> 
    <span class="nt">&quot;rfid_eligible&quot;</span><span class="p">:</span> <span class="kc">true</span> 
<span class="p">},</span> 
<span class="p">{</span> 
    <span class="nt">&quot;barcode&quot;</span><span class="p">:</span> <span class="s2">&quot;00024000566670&quot;</span><span class="p">,</span> 
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Canned Green Beans&quot;</span><span class="p">,</span> 
    <span class="nt">&quot;min_weight&quot;</span><span class="p">:</span> <span class="mf">1.025</span><span class="p">,</span> 
    <span class="nt">&quot;max_weight&quot;</span><span class="p">:</span> <span class="mf">1.050</span><span class="p">,</span> 
    <span class="nt">&quot;rfid_eligible&quot;</span><span class="p">:</span> <span class="kc">false</span> 
<span class="p">}]</span>
</code></pre></div>


<h2 id="checkout-event-reconciler">Checkout Event Reconciler</h2>
<p>The following Checkout Event Reconciler service settings can be configured. All these settings are contained in the service’s <code>ApplicationSettings</code> configuration section. All values are strings. </p>
<ul>
<li>
<p>DeviceNames - Comma separated list of device names that the service filters incoming data for. These correspond to the device names defined by the device services. </p>
</li>
<li>
<p>DevicePos - Name of the device that the POS events are received from. Must be one of the device names listed in DeviceNames above. </p>
</li>
<li>
<p>DeviceScale - Name of the device that the Scale events are received from. Must be one of the device names listed in DeviceNames above. </p>
</li>
<li>
<p>DeviceCvRoi - Name of the device that the CV ROI events are received from. Must be one of the device names listed in DeviceNames above. </p>
</li>
<li>
<p>DeviceRfidRoi - Name of the device that the RFID ROI events are received from. Must be one of the device names listed in DeviceNames above. </p>
</li>
<li>
<p>CvTimeAlignment - The time period between when a product was scanned at the POS and when it was seen by CV. This is to allow for lag between CV and the time of scan, items are reconciled only if they are within this time window, otherwise they will remain unreconciled. Values are in time duration format i.e. “5s” or “5ms” and negative values allow for an unlimited CV reconciliation window. </p>
</li>
<li>
<p>ProductLookupUrl - URL for the Product Lookup service </p>
</li>
<li>
<p>WebSocketPort - Port number for the WebSocket that the service write data. Useful for connecting UI to receive the reconciler data. </p>
</li>
<li>
<p>ScaleToScaleTolerance - Allowable difference in weight values from the scanner scale and the security (bagging) scale. Required when product quantity is a weight. Value is a fraction of LBS., I.e. “0.02” </p>
</li>
</ul>
<h2 id="loss-detector">Loss Detector</h2>
<p>The following Loss Detector service settings can be configured. All these settings are contained in the service’s <code>ApplicationSettings</code> configuration section. All values are strings. </p>
<ul>
<li>
<p>NotificationsURL - URL of the EdgeX Support Notifications Service </p>
</li>
<li>
<p>NotificationEmailAddresses - Comma separated list email addresses to send notifications </p>
</li>
<li>
<p>NotificationSlug - Unique identifier used to subscribe with the EdgeX Support Notifications Service to send notifications </p>
</li>
</ul>
<p>In addition to the above configuration items, the EdgeX Support Notifications Service must also be configured. This is done via environment variables in the <code>docker-compose.edgex.yml</code> compose file for the <code>config-seed</code> service. This reference design uses a development SMTP service running is a local docker container. The following <code>config-seed</code> environment variables must be changed when using a real SMTP service for a complete <code>RTSF at Checkout</code> solution: </p>
<ul>
<li>
<p>Smtp_Host - The of the host running the SMTP service. </p>
</li>
<li>
<p>Smtp_Port - Port number of the SMTP service running on the above host </p>
</li>
<li>
<p>Smtp_Subject - Subject to use for the email notifications  </p>
</li>
</ul>
<p>These environment variables are currently set as follows in <code>docker-compose.edgex.yml</code> compose file: </p>
<div class="codehilite"><pre><span></span><code>    <span class="nt">environment</span><span class="p">:</span>
    <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*common-variables</span>
        <span class="nt">Smtp_Host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">smtp-server</span>
        <span class="nt">Smtp_Port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">25</span>
        <span class="nt">Smtp_Subject</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">EdgeX Notification Suspect List</span>
</code></pre></div>


<h2 id="checkout-event-simulator">Checkout Event Simulator</h2>
<p>The checkout event simulator configuration contains RESTful endpoints and MQTT endpoint to send the simulated data and MQTT topic.  These settings are contained in the <code>config.json</code> file. </p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;pos_endpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:59990/api/v1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;scale_endpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:59990/api/v1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cv_roi_endpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:59990/api/v1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;rfid_roi_endpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:59990/api/v1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;rfid_events_endpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;tcp://localhost:1883&quot;</span>
<span class="p">}</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../device_services/" title="Device services" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Device services
              </div>
            </div>
          </a>
        
        
          <a href="../notifications/" title="How to Send Notifications through EdgeX (optional)" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                How to Send Notifications through EdgeX (optional)
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.f45d2d8d.min.js"></script>
      <script src="../assets/javascripts/bundle.74d0b805.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://unpkg.com/lunr/lunr.js"></script>
      
    
  </body>
</html>